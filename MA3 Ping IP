local socket = require("socket")

local function ping(ipAddress, pingCount, timeoutSeconds)
    for i = 1, pingCount do
        local pingCommand = string.format("ping -c 1 -W %d %s", timeoutSeconds, ipAddress)
        -- Capture all return values from os.execute
        local success, exitType, exitCode = os.execute(pingCommand)

        -- Check if the command was successful based on the exit code
        if success and exitCode == 0 then
            Printf(string.format("Ping %d to %s: Success", i, ipAddress))
        else
            Printf(string.format("Ping %d to %s: Failed", i, ipAddress))
        end

        socket.sleep(1) -- Sleep for 0.5 seconds between pings for network etiquette
    end
end

local function main()
    Printf("Script started") -- Debug print
    ping("127.0.0.1", 4, 1)
end

return main
